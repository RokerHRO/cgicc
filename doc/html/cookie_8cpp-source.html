<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
   "http://www.w3.org/TR/REC-html40/loose.dtd">

<html lang="en" dir="LTR">

<head>
  <!-- $Id: header.html,v 1.5 2004/06/12 01:58:25 sbooth Exp $ -->
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <title>cookie.cpp Source File</title>
  <link rev="made" href="mailto:bug-cgicc@gnu.org" />
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="cgicc-doc.css" rel="stylesheet" type="text/css" />
</head>

<body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>cookie.cpp</h1><a href="cookie_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> *  $Id: cookie.cpp,v 1.5 2003/07/13 14:22:57 sbooth Exp $</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> *  Copyright (C) 1996 - 2003 Stephen F. Booth</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> *  This program is free software; you can redistribute it and/or modify</span>
00007 <span class="comment"> *  it under the terms of the GNU General Public License as published by</span>
00008 <span class="comment"> *  the Free Software Foundation; either version 2 of the License, or</span>
00009 <span class="comment"> *  (at your option) any later version.</span>
00010 <span class="comment"> *</span>
00011 <span class="comment"> *  This program is distributed in the hope that it will be useful,</span>
00012 <span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00013 <span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00014 <span class="comment"> *  GNU General Public License for more details.</span>
00015 <span class="comment"> *</span>
00016 <span class="comment"> *  You should have received a copy of the GNU General Public License</span>
00017 <span class="comment"> *  along with this program; if not, write to the Free Software</span>
00018 <span class="comment"> *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00019 <span class="comment"> */</span>
00020 
00027 <span class="preprocessor">#include &lt;new&gt;</span>
00028 <span class="preprocessor">#include &lt;string&gt;</span>
00029 <span class="preprocessor">#include &lt;vector&gt;</span>
00030 <span class="preprocessor">#include &lt;stdexcept&gt;</span>
00031 <span class="preprocessor">#include &lt;iostream&gt;</span>
00032 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
00033 
00034 <span class="preprocessor">#include "<a class="code" href="CgiDefs_8h.html">cgicc/CgiDefs.h</a>"</span>
00035 <span class="preprocessor">#include "<a class="code" href="Cgicc_8h.html">cgicc/Cgicc.h</a>"</span>
00036 <span class="preprocessor">#include "<a class="code" href="HTTPHTMLHeader_8h.html">cgicc/HTTPHTMLHeader.h</a>"</span>
00037 <span class="preprocessor">#include "<a class="code" href="HTMLClasses_8h.html">cgicc/HTMLClasses.h</a>"</span>
00038 
00039 <span class="preprocessor">#if HAVE_UNAME</span>
00040 <span class="preprocessor"></span><span class="preprocessor">#  include &lt;sys/utsname.h&gt;</span>
00041 <span class="preprocessor">#endif</span>
00042 <span class="preprocessor"></span>
00043 <span class="preprocessor">#if HAVE_SYS_TIME_H</span>
00044 <span class="preprocessor"></span><span class="preprocessor">#  include &lt;sys/time.h&gt;</span>
00045 <span class="preprocessor">#endif</span>
00046 <span class="preprocessor"></span>
00047 <span class="comment">// To use logging, the variable gLogFile MUST be defined, and it _must_</span>
00048 <span class="comment">// be an ofstream</span>
00049 <span class="preprocessor">#if DEBUG</span>
00050 <span class="preprocessor"></span>  std::ofstream gLogFile( <span class="stringliteral">"/change_this_path/cgicc.log"</span>, std::ios::app );
00051 <span class="preprocessor">#endif</span>
00052 <span class="preprocessor"></span>
00053 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00054 <span class="keyword">using</span> <span class="keyword">namespace </span>cgicc;
00055 
00056 <span class="comment">// Main Street, USA</span>
00057 <span class="keywordtype">int</span>
00058 main(<span class="keywordtype">int</span> <span class="comment">/*argc*/</span>, 
00059      <span class="keywordtype">char</span> ** <span class="comment">/*argv*/</span>)
00060 {
00061   <span class="keywordflow">try</span> {
00062 <span class="preprocessor">#if HAVE_GETTIMEOFDAY</span>
00063 <span class="preprocessor"></span>    timeval start;
00064     gettimeofday(&amp;start, NULL);
00065 <span class="preprocessor">#endif</span>
00066 <span class="preprocessor"></span>
00067     <span class="comment">// Create a new Cgicc object containing all the CGI data</span>
00068     <a class="code" href="classcgicc_1_1Cgicc.html">Cgicc</a> cgi;
00069 
00070     <span class="comment">// Get the name and value of the cookie to set</span>
00071     <a class="code" href="namespacecgicc.html#a1">const_form_iterator</a> name = cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z5_3">getElement</a>(<span class="stringliteral">"name"</span>);
00072     <a class="code" href="namespacecgicc.html#a1">const_form_iterator</a> value = cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z5_3">getElement</a>(<span class="stringliteral">"value"</span>);
00073 
00074     <span class="comment">// Output the headers for an HTML document with the cookie only</span>
00075     <span class="comment">// if the cookie is not empty</span>
00076     <span class="keywordflow">if</span>(name != cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z5_10">getElements</a>().end() &amp;&amp; value != cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z5_10">getElements</a>().end()
00077        &amp;&amp; value-&gt;getValue().empty() == <span class="keyword">false</span>)
00078       cout &lt;&lt; <a class="code" href="classcgicc_1_1HTTPHTMLHeader.html">HTTPHTMLHeader</a>()
00079         .setCookie(<a class="code" href="classcgicc_1_1HTTPCookie.html">HTTPCookie</a>(name-&gt;getValue(), value-&gt;getValue()));
00080     <span class="keywordflow">else</span>
00081       cout &lt;&lt; HTTPHTMLHeader();
00082     
00083     <span class="comment">// Output the HTML 4.0 DTD info</span>
00084     cout &lt;&lt; <a class="code" href="classcgicc_1_1HTMLDoctype.html">HTMLDoctype</a>(HTMLDoctype::eStrict) &lt;&lt; endl;
00085     cout &lt;&lt; html().set(<span class="stringliteral">"lang"</span>, <span class="stringliteral">"en"</span>).set(<span class="stringliteral">"dir"</span>, <span class="stringliteral">"ltr"</span>) &lt;&lt; endl;
00086 
00087     <span class="comment">// Set up the page's header and title.</span>
00088     <span class="comment">// I will put in lfs to ease reading of the produced HTML. </span>
00089     cout &lt;&lt; head() &lt;&lt; endl;
00090 
00091     <span class="comment">// Output the style sheet portion of the header</span>
00092     cout &lt;&lt; style() &lt;&lt; <a class="code" href="classcgicc_1_1comment.html">comment</a>() &lt;&lt; endl;
00093     cout &lt;&lt; <span class="stringliteral">"body { color: black; background-color: white; }"</span> &lt;&lt; endl;
00094     cout &lt;&lt; <span class="stringliteral">"hr.half { width: 60%; align: center; }"</span> &lt;&lt; endl;
00095     cout &lt;&lt; <span class="stringliteral">"span.red, strong.red { color: red; }"</span> &lt;&lt; endl;
00096     cout &lt;&lt; <span class="stringliteral">"div.smaller { font-size: small; }"</span> &lt;&lt; endl;
00097     cout &lt;&lt; <span class="stringliteral">"div.notice { border: solid thin; padding: 1em; margin: 1em 0; "</span>
00098          &lt;&lt; <span class="stringliteral">"background: #ddd; }"</span> &lt;&lt; endl;
00099     cout &lt;&lt; <span class="stringliteral">"span.blue { color: blue; }"</span> &lt;&lt; endl;
00100     cout &lt;&lt; <span class="stringliteral">"col.title { color: white; background-color: black; "</span>;
00101     cout &lt;&lt; <span class="stringliteral">"font-weight: bold; text-align: center; }"</span> &lt;&lt; endl;
00102     cout &lt;&lt; <span class="stringliteral">"col.data { background-color: #ddd; text-align: left; }"</span> &lt;&lt; endl;
00103     cout &lt;&lt; <span class="stringliteral">"td.data, TR.data { background-color: #ddd; text-align: left; }"</span>
00104          &lt;&lt; endl;
00105     cout &lt;&lt; <span class="stringliteral">"td.grayspecial { background-color: #ddd; text-align: left; }"</span>
00106          &lt;&lt; endl;
00107     cout &lt;&lt; <span class="stringliteral">"td.ltgray, tr.ltgray { background-color: #ddd; }"</span> &lt;&lt; endl;
00108     cout &lt;&lt; <span class="stringliteral">"td.dkgray, tr.dkgray { background-color: #bbb; }"</span> &lt;&lt; endl;
00109     cout &lt;&lt; <span class="stringliteral">"col.black, td.black, td.title, tr.title { color: white; "</span> 
00110          &lt;&lt; <span class="stringliteral">"background-color: black; font-weight: bold; text-align: center; }"</span>
00111          &lt;&lt; endl;
00112     cout &lt;&lt; <span class="stringliteral">"col.gray, td.gray { background-color: #ddd; text-align: center; }"</span>
00113          &lt;&lt; endl;
00114     cout &lt;&lt; <span class="stringliteral">"table.cgi { left-margin: auto; right-margin: auto; width: 90%; }"</span>
00115          &lt;&lt; endl;
00116 
00117     cout &lt;&lt; comment() &lt;&lt; style() &lt;&lt; endl;
00118 
00119     cout &lt;&lt; title() &lt;&lt; <span class="stringliteral">"GNU cgicc v"</span> &lt;&lt; cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z3_2">getVersion</a>() 
00120          &lt;&lt; <span class="stringliteral">" HTTPCookie Results"</span> &lt;&lt; title() &lt;&lt; endl;
00121 
00122     cout &lt;&lt; head() &lt;&lt; endl;
00123     
00124     <span class="comment">// Start the HTML body</span>
00125     cout &lt;&lt; body() &lt;&lt; endl;
00126 
00127     cout &lt;&lt; h1() &lt;&lt; <span class="stringliteral">"GNU cgi"</span> &lt;&lt; span(<span class="stringliteral">"cc"</span>).set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"red"</span>)
00128          &lt;&lt; <span class="stringliteral">" v"</span>&lt;&lt; cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z3_2">getVersion</a>() &lt;&lt; <span class="stringliteral">" HTTPCookie Test Results"</span> 
00129          &lt;&lt; h1() &lt;&lt; endl;
00130     
00131     <span class="comment">// Get a pointer to the environment</span>
00132     <span class="keyword">const</span> <a class="code" href="classcgicc_1_1CgiEnvironment.html">CgiEnvironment</a>&amp; env = cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z9_0">getEnvironment</a>();
00133     
00134     <span class="comment">// Generic thank you message</span>
00135     cout &lt;&lt; comment() &lt;&lt; <span class="stringliteral">"This page generated by cgicc for "</span>
00136          &lt;&lt; env.<a class="code" href="classcgicc_1_1CgiEnvironment.html#z21_0">getRemoteHost</a>() &lt;&lt; comment() &lt;&lt; endl;
00137     cout &lt;&lt; h4() &lt;&lt; <span class="stringliteral">"Thanks for using cgi"</span> &lt;&lt; span(<span class="stringliteral">"cc"</span>).set(<span class="stringliteral">"class"</span>, <span class="stringliteral">"red"</span>) 
00138          &lt;&lt; <span class="stringliteral">", "</span> &lt;&lt; env.<a class="code" href="classcgicc_1_1CgiEnvironment.html#z21_0">getRemoteHost</a>() 
00139          &lt;&lt; <span class="charliteral">'('</span> &lt;&lt; env.<a class="code" href="classcgicc_1_1CgiEnvironment.html#z21_1">getRemoteAddr</a>() &lt;&lt; <span class="stringliteral">")!"</span> &lt;&lt; h4() &lt;&lt; endl;  
00140     
00141     <span class="keywordflow">if</span>(name != cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z5_10">getElements</a>().end() &amp;&amp; value != cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z5_10">getElements</a>().end()
00142        &amp;&amp; value-&gt;getValue().empty() == <span class="keyword">false</span>) {
00143       cout &lt;&lt; p() &lt;&lt; <span class="stringliteral">"A cookie with the name "</span> &lt;&lt; em(name-&gt;getValue())
00144            &lt;&lt; <span class="stringliteral">" and value "</span> &lt;&lt; em(value-&gt;getValue()) &lt;&lt; <span class="stringliteral">" was set."</span> &lt;&lt; br();
00145       cout &lt;&lt; <span class="stringliteral">"In order for the cookie to show up here you must "</span>
00146            &lt;&lt; a(<span class="stringliteral">"refresh"</span>).set(<span class="stringliteral">"href"</span>,env.<a class="code" href="classcgicc_1_1CgiEnvironment.html#z17_5">getScriptName</a>()) &lt;&lt; p();
00147     }
00148 
00149     <span class="comment">// Show the cookie info from the environment</span>
00150     cout &lt;&lt; h2(<span class="stringliteral">"Cookie Information from the Environment"</span>) &lt;&lt; endl;
00151   
00152     cout &lt;&lt; cgicc::div().set(<span class="stringliteral">"align"</span>,<span class="stringliteral">"center"</span>) &lt;&lt; endl;
00153     
00154     cout &lt;&lt; table().set(<span class="stringliteral">"border"</span>,<span class="stringliteral">"0"</span>).set(<span class="stringliteral">"rules"</span>,<span class="stringliteral">"none"</span>).set(<span class="stringliteral">"frame"</span>,<span class="stringliteral">"void"</span>)
00155       .set(<span class="stringliteral">"cellspacing"</span>,<span class="stringliteral">"2"</span>).set(<span class="stringliteral">"cellpadding"</span>,<span class="stringliteral">"2"</span>)
00156       .set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"cgi"</span>) &lt;&lt; endl;
00157     cout &lt;&lt; colgroup().set(<span class="stringliteral">"span"</span>,<span class="stringliteral">"2"</span>) &lt;&lt; endl;
00158     cout &lt;&lt; col().set(<span class="stringliteral">"align"</span>,<span class="stringliteral">"center"</span>).set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"title"</span>).set(<span class="stringliteral">"span"</span>,<span class="stringliteral">"1"</span>) 
00159          &lt;&lt; endl;
00160     cout &lt;&lt; col().set(<span class="stringliteral">"align"</span>,<span class="stringliteral">"left"</span>).set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"data"</span>).set(<span class="stringliteral">"span"</span>,<span class="stringliteral">"1"</span>) 
00161          &lt;&lt; endl;
00162     cout &lt;&lt; colgroup() &lt;&lt; endl;
00163     
00164     cout &lt;&lt; tr() &lt;&lt; td(<span class="stringliteral">"HTTPCookie"</span>).set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"title"</span>)
00165          &lt;&lt; td(env.<a class="code" href="classcgicc_1_1CgiEnvironment.html#z17_0">getCookies</a>()).set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"data"</span>) &lt;&lt; tr() &lt;&lt; endl;
00166     
00167     cout &lt;&lt; table() &lt;&lt; cgicc::div() &lt;&lt; endl;
00168 
00169 
00170     <span class="comment">// Show the cookie info from the cookie list</span>
00171     cout &lt;&lt; h2(<span class="stringliteral">"HTTP Cookies via vector"</span>) &lt;&lt; endl;
00172   
00173     cout &lt;&lt; cgicc::div().set(<span class="stringliteral">"align"</span>,<span class="stringliteral">"center"</span>) &lt;&lt; endl;
00174   
00175     cout &lt;&lt; table().set(<span class="stringliteral">"border"</span>,<span class="stringliteral">"0"</span>).set(<span class="stringliteral">"rules"</span>,<span class="stringliteral">"none"</span>).set(<span class="stringliteral">"frame"</span>,<span class="stringliteral">"void"</span>)
00176       .set(<span class="stringliteral">"cellspacing"</span>,<span class="stringliteral">"2"</span>).set(<span class="stringliteral">"cellpadding"</span>,<span class="stringliteral">"2"</span>)
00177       .set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"cgi"</span>) &lt;&lt; endl;
00178     cout &lt;&lt; colgroup().set(<span class="stringliteral">"span"</span>,<span class="stringliteral">"2"</span>) &lt;&lt; endl;
00179     cout &lt;&lt; col().set(<span class="stringliteral">"align"</span>,<span class="stringliteral">"center"</span>).set(<span class="stringliteral">"span"</span>,<span class="stringliteral">"2"</span>) &lt;&lt; endl;
00180     cout &lt;&lt; colgroup() &lt;&lt; endl;
00181     
00182     cout &lt;&lt; tr().set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"title"</span>) &lt;&lt; td(<span class="stringliteral">"Cookie Name"</span>) 
00183          &lt;&lt; td(<span class="stringliteral">"Cookie Value"</span>) &lt;&lt; tr() &lt;&lt; endl;
00184     
00185     <span class="comment">// Iterate through the vector, and print out each value</span>
00186     <a class="code" href="namespacecgicc.html#a5">const_cookie_iterator</a> iter;
00187     <span class="keywordflow">for</span>(iter = env.<a class="code" href="classcgicc_1_1CgiEnvironment.html#z17_1">getCookieList</a>().begin(); 
00188         iter != env.<a class="code" href="classcgicc_1_1CgiEnvironment.html#z17_1">getCookieList</a>().end(); 
00189         ++iter) {
00190       cout &lt;&lt; tr().set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"data"</span>) &lt;&lt; td(iter-&gt;getName()) 
00191            &lt;&lt; td(iter-&gt;getValue()) &lt;&lt; tr() &lt;&lt; endl;
00192     }
00193     cout &lt;&lt; table() &lt;&lt; cgicc::div() &lt;&lt; endl;
00194     
00195 
00196     <span class="comment">// Now print out a footer with some fun info</span>
00197     cout &lt;&lt; p() &lt;&lt; cgicc::div().set(<span class="stringliteral">"align"</span>,<span class="stringliteral">"center"</span>);
00198     cout &lt;&lt; a(<span class="stringliteral">"Back to form"</span>).set(<span class="stringliteral">"href"</span>, cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z9_0">getEnvironment</a>().<a class="code" href="classcgicc_1_1CgiEnvironment.html#z19_0">getReferrer</a>()) 
00199          &lt;&lt; endl;
00200     cout &lt;&lt; cgicc::div() &lt;&lt; br() &lt;&lt; hr(<a class="code" href="namespacecgicc.html#a18">set</a>(<span class="stringliteral">"class"</span>,<span class="stringliteral">"half"</span>)) &lt;&lt; endl;
00201     
00202     <span class="comment">// Information on cgicc</span>
00203     cout &lt;&lt; cgicc::div().set(<span class="stringliteral">"align"</span>,<span class="stringliteral">"center"</span>).set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"smaller"</span>) &lt;&lt; endl;
00204     cout &lt;&lt; <span class="stringliteral">"GNU cgi"</span> &lt;&lt; span(<span class="stringliteral">"cc"</span>).set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"red"</span>) &lt;&lt; <span class="stringliteral">" v"</span>;
00205     cout &lt;&lt; cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z3_2">getVersion</a>() &lt;&lt; br() &lt;&lt; endl;
00206     cout &lt;&lt; <span class="stringliteral">"Compiled at "</span> &lt;&lt; cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z3_1">getCompileTime</a>();
00207     cout &lt;&lt; <span class="stringliteral">" on "</span> &lt;&lt; cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z3_0">getCompileDate</a>() &lt;&lt; br() &lt;&lt; endl;
00208 
00209     cout &lt;&lt; <span class="stringliteral">"Configured for "</span> &lt;&lt; cgi.<a class="code" href="classcgicc_1_1Cgicc.html#z3_3">getHost</a>();  
00210 <span class="preprocessor">#if HAVE_UNAME</span>
00211 <span class="preprocessor"></span>    <span class="keyword">struct </span>utsname info;
00212     <span class="keywordflow">if</span>(uname(&amp;info) != -1) {
00213       cout &lt;&lt; <span class="stringliteral">". Running on "</span> &lt;&lt; info.sysname;
00214       cout &lt;&lt; <span class="charliteral">' '</span> &lt;&lt; info.release &lt;&lt; <span class="stringliteral">" ("</span>;
00215       cout &lt;&lt; info.nodename &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; endl;
00216     }
00217 <span class="preprocessor">#else</span>
00218 <span class="preprocessor"></span>    cout &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; endl;
00219 <span class="preprocessor">#endif</span>
00220 <span class="preprocessor"></span>
00221 <span class="preprocessor">#if HAVE_GETTIMEOFDAY</span>
00222 <span class="preprocessor"></span>    <span class="comment">// Information on this query</span>
00223     timeval end;
00224     gettimeofday(&amp;end, NULL);
00225     <span class="keywordtype">long</span> us = ((end.tv_sec - start.tv_sec) * 1000000)
00226       + (end.tv_usec - start.tv_usec);
00227 
00228     cout &lt;&lt; br() &lt;&lt; <span class="stringliteral">"Total time for request = "</span> &lt;&lt; us &lt;&lt; <span class="stringliteral">" us"</span>;
00229     cout &lt;&lt; <span class="stringliteral">" ("</span> &lt;&lt; (<span class="keywordtype">double</span>) (us/1000000.0) &lt;&lt; <span class="stringliteral">" s)"</span>;
00230 <span class="preprocessor">#endif</span>
00231 <span class="preprocessor"></span>
00232     <span class="comment">// End of document</span>
00233     cout &lt;&lt; cgicc::div() &lt;&lt; endl;
00234     cout &lt;&lt; body() &lt;&lt; html() &lt;&lt; endl;
00235 
00236     <span class="comment">// No chance for failure in this example</span>
00237     <span class="keywordflow">return</span> EXIT_SUCCESS;
00238   }
00239 
00240   <span class="comment">// Did any errors occur?</span>
00241   <span class="keywordflow">catch</span>(<span class="keyword">const</span> std::exception&amp; e) {
00242 
00243     <span class="comment">// This is a dummy exception handler, as it doesn't really do</span>
00244     <span class="comment">// anything except print out information.</span>
00245 
00246     <span class="comment">// Reset all the HTML elements that might have been used to </span>
00247     <span class="comment">// their initial state so we get valid output</span>
00248     html::reset();      head::reset();          body::reset();
00249     title::reset();     h1::reset();            h4::reset();
00250     <a class="code" href="classcgicc_1_1HTMLBooleanElement.html#z65_2">comment::reset</a>();   td::reset();            tr::reset(); 
00251     table::reset();     cgicc::div::reset();    p::reset(); 
00252     a::reset();         h2::reset();            colgroup::reset();
00253 
00254     <span class="comment">// Output the HTTP headers for an HTML document, and the HTML 4.0 DTD info</span>
00255     cout &lt;&lt; HTTPHTMLHeader() &lt;&lt; HTMLDoctype(HTMLDoctype::eStrict) &lt;&lt; endl;
00256     cout &lt;&lt; html().set(<span class="stringliteral">"lang"</span>,<span class="stringliteral">"en"</span>).set(<span class="stringliteral">"dir"</span>,<span class="stringliteral">"ltr"</span>) &lt;&lt; endl;
00257 
00258     <span class="comment">// Set up the page's header and title.</span>
00259     <span class="comment">// I will put in lfs to ease reading of the produced HTML. </span>
00260     cout &lt;&lt; head() &lt;&lt; endl;
00261 
00262     <span class="comment">// Output the style sheet portion of the header</span>
00263     cout &lt;&lt; style() &lt;&lt; comment() &lt;&lt; endl;
00264     cout &lt;&lt; <span class="stringliteral">"body { color: black; background-color: white; }"</span> &lt;&lt; endl;
00265     cout &lt;&lt; <span class="stringliteral">"hr.half { width: 60%; align: center; }"</span> &lt;&lt; endl;
00266     cout &lt;&lt; <span class="stringliteral">"span.red, strong.red { color: red; }"</span> &lt;&lt; endl;
00267     cout &lt;&lt; <span class="stringliteral">"div.notice { border: solid thin; padding: 1em; margin: 1em 0; "</span>
00268          &lt;&lt; <span class="stringliteral">"background: #ddd; }"</span> &lt;&lt; endl;
00269 
00270     cout &lt;&lt; comment() &lt;&lt; style() &lt;&lt; endl;
00271 
00272     cout &lt;&lt; title(<span class="stringliteral">"GNU cgicc exception"</span>) &lt;&lt; endl;
00273     cout &lt;&lt; head() &lt;&lt; endl;
00274     
00275     cout &lt;&lt; body() &lt;&lt; endl;
00276     
00277     cout &lt;&lt; h1() &lt;&lt; <span class="stringliteral">"GNU cgi"</span> &lt;&lt; span(<span class="stringliteral">"cc"</span>, <a class="code" href="namespacecgicc.html#a18">set</a>(<span class="stringliteral">"class"</span>,<span class="stringliteral">"red"</span>))
00278          &lt;&lt; <span class="stringliteral">" caught an exception"</span> &lt;&lt; h1() &lt;&lt; endl; 
00279   
00280     cout &lt;&lt; cgicc::div().set(<span class="stringliteral">"align"</span>,<span class="stringliteral">"center"</span>).set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"notice"</span>) &lt;&lt; endl;
00281 
00282     cout &lt;&lt; h2(e.what()) &lt;&lt; endl;
00283 
00284     <span class="comment">// End of document</span>
00285     cout &lt;&lt; cgicc::div() &lt;&lt; endl;
00286     cout &lt;&lt; hr().set(<span class="stringliteral">"class"</span>,<span class="stringliteral">"half"</span>) &lt;&lt; endl;
00287     cout &lt;&lt; body() &lt;&lt; html() &lt;&lt; endl;
00288     
00289     <span class="keywordflow">return</span> EXIT_SUCCESS;
00290   }
00291 }
</pre></div><!-- $Id: footer.html,v 1.7 2004/06/12 01:58:25 sbooth Exp $ -->

<hr>

<address><small>
<a href="http://www.cgicc.org">GNU cgicc</a> - A C++ class library for
writing CGI applications<br />
Copyright &copy; 1996 - 2004 
<a href="mailto:sboothATgnuDOTorg">Stephen F. Booth</a><br />
Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.1 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with no Front Cover Texts, and with no Back-Cover
Texts.<br />
Documentation generated Sat Jun 19 00:36:23 2004 for cgicc by
<a HREF="http://www.doxygen.org/index.html">doxygen</a> 1.3.6
</small></address>

</body>

</html>

