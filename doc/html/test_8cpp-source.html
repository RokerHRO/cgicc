<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
   "http://www.w3.org/TR/REC-html40/loose.dtd">

<html lang="en" dir="LTR">

<head>
  <!-- $Id: header.html,v 1.3 2002/03/09 18:30:37 sbooth Exp $ -->
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <title>test.cpp Source File</title>
  <link rev="made" href="mailto:bug-cgicc@gnu.org" />
  <link href="cgicc-doc.css" rel="stylesheet" type="text/css" />
</head>

<body>
<!-- Generated by Doxygen 1.2.13.1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>test.cpp</h1><a href="test_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment"> *  $Id: test.cpp,v 1.18 2002/03/03 17:41:44 sbooth Exp $</font>
00003 <font class="comment"> *</font>
00004 <font class="comment"> *  Copyright (C) 1996 - 2002 Stephen F. Booth</font>
00005 <font class="comment"> *</font>
00006 <font class="comment"> *  This program is free software; you can redistribute it and/or modify</font>
00007 <font class="comment"> *  it under the terms of the GNU General Public License as published by</font>
00008 <font class="comment"> *  the Free Software Foundation; either version 2 of the License, or</font>
00009 <font class="comment"> *  (at your option) any later version.</font>
00010 <font class="comment"> *</font>
00011 <font class="comment"> *  This program is distributed in the hope that it will be useful,</font>
00012 <font class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00013 <font class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font>
00014 <font class="comment"> *  GNU General Public License for more details.</font>
00015 <font class="comment"> *</font>
00016 <font class="comment"> *  You should have received a copy of the GNU General Public License</font>
00017 <font class="comment"> *  along with this program; if not, write to the Free Software</font>
00018 <font class="comment"> *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</font>
00019 <font class="comment"> */</font>
00020 
00027 <font class="preprocessor">#include &lt;new&gt;</font>
00028 <font class="preprocessor">#include &lt;string&gt;</font>
00029 <font class="preprocessor">#include &lt;vector&gt;</font>
00030 <font class="preprocessor">#include &lt;stdexcept&gt;</font>
00031 <font class="preprocessor">#include &lt;iostream&gt;</font>
00032 <font class="preprocessor">#include &lt;cstdlib&gt;</font>
00033 
00034 <font class="preprocessor">#include "<a class="code" href="CgiDefs_8h.html">cgicc/CgiDefs.h</a>"</font>
00035 <font class="preprocessor">#include "<a class="code" href="Cgicc_8h.html">cgicc/Cgicc.h</a>"</font>
00036 <font class="preprocessor">#include "<a class="code" href="HTTPHTMLHeader_8h.html">cgicc/HTTPHTMLHeader.h</a>"</font>
00037 <font class="preprocessor">#include "<a class="code" href="HTMLClasses_8h.html">cgicc/HTMLClasses.h</a>"</font>
00038 
00039 <font class="preprocessor">#if HAVE_UNAME</font>
00040 <font class="preprocessor"></font><font class="preprocessor">#  include &lt;sys/utsname.h&gt;</font>
00041 <font class="preprocessor">#endif</font>
00042 <font class="preprocessor"></font>
00043 <font class="preprocessor">#if HAVE_SYS_TIME_H</font>
00044 <font class="preprocessor"></font><font class="preprocessor">#  include &lt;sys/time.h&gt;</font>
00045 <font class="preprocessor">#endif</font>
00046 <font class="preprocessor"></font>
00047 <font class="comment">// To use logging, the variable gLogFile MUST be defined, and it _must_</font>
00048 <font class="comment">// be an ofstream</font>
00049 <font class="preprocessor">#if DEBUG</font>
00050 <font class="preprocessor"></font>  STDNS ofstream gLogFile( <font class="stringliteral">"/change_this_path/cgicc.log"</font>, STDNS ios::app );
00051 <font class="preprocessor">#endif</font>
00052 <font class="preprocessor"></font>
00053 <font class="preprocessor">#if CGICC_USE_NAMESPACES</font>
00054 <font class="preprocessor"></font>  <font class="keyword">using</font> <font class="keyword">namespace </font>std;
00055   <font class="keyword">using</font> <font class="keyword">namespace </font>cgicc;
00056 <font class="preprocessor">#else</font>
00057 <font class="preprocessor"></font><font class="preprocessor">#  define div div_</font>
00058 <font class="preprocessor"></font><font class="preprocessor">#  define link link_</font>
00059 <font class="preprocessor"></font><font class="preprocessor">#  define select select_</font>
00060 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00061 <font class="preprocessor"></font>
00062 <font class="comment">// Function prototypes</font>
00063 <font class="keywordtype">void</font> dumpEnvironment(<font class="keyword">const</font> CgiEnvironment&amp; env);
00064 <font class="keywordtype">void</font> dumpList(<font class="keyword">const</font> Cgicc&amp; formData);
00065 <font class="keywordtype">void</font> showForm(<font class="keyword">const</font> Cgicc&amp; formData);
00066 
00067 <font class="comment">// Main Street, USA</font>
00068 <font class="keywordtype">int</font>
00069 main(<font class="keywordtype">int</font> <font class="comment">/*argc*/</font>, 
00070      <font class="keywordtype">char</font> ** <font class="comment">/*argv*/</font>)
00071 {
00072   <font class="keywordflow">try</font> {
00073 <font class="preprocessor">#if HAVE_GETTIMEOFDAY</font>
00074 <font class="preprocessor"></font>    timeval start;
00075     gettimeofday(&amp;start, NULL);
00076 <font class="preprocessor">#endif</font>
00077 <font class="preprocessor"></font>
00078     <font class="comment">// Create a new Cgicc object containing all the CGI data</font>
00079     Cgicc cgi;
00080     
00081     <font class="comment">// If the user wants to throw an exception, go ahead and do it</font>
00082     <font class="keywordflow">if</font>(cgi.queryCheckbox(<font class="stringliteral">"throw"</font>) &amp;&amp; ! cgi.queryCheckbox(<font class="stringliteral">"restore"</font>))
00083       <font class="keywordflow">throw</font> STDNS runtime_error(<font class="stringliteral">"User-requested Exception thrown in main()"</font>);
00084     
00085     <font class="comment">// Output the HTTP headers for an HTML document, and the HTML 4.0 DTD info</font>
00086     cout &lt;&lt; HTTPHTMLHeader() &lt;&lt; HTMLDoctype(HTMLDoctype::eStrict) &lt;&lt; endl;
00087     cout &lt;&lt; html().set(<font class="stringliteral">"lang"</font>, <font class="stringliteral">"en"</font>).set(<font class="stringliteral">"dir"</font>, <font class="stringliteral">"ltr"</font>) &lt;&lt; endl;
00088 
00089     <font class="comment">// Set up the page's header and title.</font>
00090     <font class="comment">// I will put in lfs to ease reading of the produced HTML. </font>
00091     cout &lt;&lt; head() &lt;&lt; endl;
00092 
00093     <font class="comment">// Output the style sheet portion of the header</font>
00094     cout &lt;&lt; style() &lt;&lt; comment() &lt;&lt; endl;
00095     cout &lt;&lt; <font class="stringliteral">"body { color: black; background-color: white; }"</font> &lt;&lt; endl;
00096     cout &lt;&lt; <font class="stringliteral">"hr.half { width: 60%; align: center; }"</font> &lt;&lt; endl;
00097     cout &lt;&lt; <font class="stringliteral">"span.red, strong.red { color: red; }"</font> &lt;&lt; endl;
00098     cout &lt;&lt; <font class="stringliteral">"div.smaller { font-size: small; }"</font> &lt;&lt; endl;
00099     cout &lt;&lt; <font class="stringliteral">"div.notice { border: solid thin; padding: 1em; margin: 1em 0; "</font>
00100          &lt;&lt; <font class="stringliteral">"background: #ddd; }"</font> &lt;&lt; endl;
00101     cout &lt;&lt; <font class="stringliteral">"span.blue { color: blue; }"</font> &lt;&lt; endl;
00102     cout &lt;&lt; <font class="stringliteral">"col.title { color: white; background-color: black; "</font>;
00103     cout &lt;&lt; <font class="stringliteral">"font-weight: bold; text-align: center; }"</font> &lt;&lt; endl;
00104     cout &lt;&lt; <font class="stringliteral">"col.data { background-color: #DDD; text-align: left; }"</font> &lt;&lt; endl;
00105     cout &lt;&lt; <font class="stringliteral">"td.data, tr.data { background-color: #ddd; text-align: left; }"</font>
00106          &lt;&lt; endl;
00107     cout &lt;&lt; <font class="stringliteral">"td.grayspecial { background-color: #ddd; text-align: left; }"</font>
00108          &lt;&lt; endl;
00109     cout &lt;&lt; <font class="stringliteral">"td.ltgray, tr.ltgray { background-color: #ddd; }"</font> &lt;&lt; endl;
00110     cout &lt;&lt; <font class="stringliteral">"td.dkgray, tr.dkgray { background-color: #bbb; }"</font> &lt;&lt; endl;
00111     cout &lt;&lt; <font class="stringliteral">"col.black, td.black, td.title, tr.title { color: white; "</font> 
00112          &lt;&lt; <font class="stringliteral">"background-color: black; font-weight: bold; text-align: center; }"</font>
00113          &lt;&lt; endl;
00114     cout &lt;&lt; <font class="stringliteral">"col.gray, td.gray { background-color: #ddd; text-align: center; }"</font>
00115          &lt;&lt; endl;
00116     cout &lt;&lt; <font class="stringliteral">"table.cgi { left-margin: auto; right-margin: auto; width: 90%; }"</font>
00117          &lt;&lt; endl;
00118 
00119     cout &lt;&lt; comment() &lt;&lt; style() &lt;&lt; endl;
00120 
00121     cout &lt;&lt; title() &lt;&lt; <font class="stringliteral">"GNU cgicc v"</font> &lt;&lt; cgi.getVersion() &lt;&lt; <font class="stringliteral">" Test Results"</font> 
00122          &lt;&lt; title() &lt;&lt; endl;
00123 
00124     cout &lt;&lt; head() &lt;&lt; endl;
00125     
00126     <font class="comment">// Start the HTML body</font>
00127     cout &lt;&lt; body() &lt;&lt; endl;
00128 
00129     cout &lt;&lt; h1() &lt;&lt; <font class="stringliteral">"GNU cgi"</font> &lt;&lt; span(<font class="stringliteral">"cc"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"red"</font>)
00130          &lt;&lt; <font class="stringliteral">" v"</font>&lt;&lt; cgi.getVersion() &lt;&lt; <font class="stringliteral">" Test Results"</font> &lt;&lt; h1() &lt;&lt; endl;
00131     
00132     <font class="comment">// Get a pointer to the environment</font>
00133     <font class="keyword">const</font> CgiEnvironment&amp; env = cgi.getEnvironment();
00134     
00135     <font class="comment">// Generic thank you message</font>
00136     cout &lt;&lt; comment() &lt;&lt; <font class="stringliteral">"This page generated by cgicc for "</font>
00137          &lt;&lt; env.getRemoteHost() &lt;&lt; comment() &lt;&lt; endl;
00138     cout &lt;&lt; h4() &lt;&lt; <font class="stringliteral">"Thanks for using cgi"</font> &lt;&lt; span(<font class="stringliteral">"cc"</font>).set(<font class="stringliteral">"class"</font>, <font class="stringliteral">"red"</font>) 
00139          &lt;&lt; <font class="stringliteral">", "</font> &lt;&lt; env.getRemoteHost() 
00140          &lt;&lt; <font class="charliteral">'('</font> &lt;&lt; env.getRemoteAddr() &lt;&lt; <font class="stringliteral">")!"</font> &lt;&lt; h4() &lt;&lt; endl;  
00141     
00142     <font class="comment">// If the user wants to save the submission, do it</font>
00143     <font class="keywordflow">if</font>(cgi.queryCheckbox(<font class="stringliteral">"save"</font>)) {
00144       cgi.save(<font class="stringliteral">"save"</font>);
00145       cout &lt;&lt; p(h2(<font class="stringliteral">"Data Saved"</font>)) &lt;&lt; endl;
00146       
00147       cout &lt;&lt; CGICCNS div().set(<font class="stringliteral">"class"</font>, <font class="stringliteral">"notice"</font>) &lt;&lt; endl;
00148       cout &lt;&lt; <font class="stringliteral">"Your data has been saved, and may be restored (by anyone) "</font>
00149            &lt;&lt; <font class="stringliteral">"via the same form."</font> &lt;&lt; endl &lt;&lt; CGICCNS div() &lt;&lt; p() &lt;&lt; endl;
00150     }
00151 
00152     <font class="comment">// If the user wants to restore from the last submission, do it</font>
00153     <font class="keywordflow">if</font>(cgi.queryCheckbox(<font class="stringliteral">"restore"</font>)) {
00154       cgi.restore(<font class="stringliteral">"save"</font>);
00155       cout &lt;&lt; p(h2(<font class="stringliteral">"Data Restored"</font>)) &lt;&lt; endl;
00156       
00157       cout &lt;&lt; CGICCNS div().set(<font class="stringliteral">"class"</font>, <font class="stringliteral">"notice"</font>) &lt;&lt; endl;
00158       cout &lt;&lt; <font class="stringliteral">"The data displayed has been restored from a file on disk."</font>
00159            &lt;&lt; endl &lt;&lt; CGICCNS div() &lt;&lt; p() &lt;&lt; endl;
00160     }
00161     
00162     <font class="comment">// If the user requested a dump of the environment,</font>
00163     <font class="comment">// create a simple table showing the values of the </font>
00164     <font class="comment">// environment variables</font>
00165     <font class="keywordflow">if</font>(cgi.queryCheckbox(<font class="stringliteral">"showEnv"</font>))
00166       dumpEnvironment(env);
00167     
00168     <font class="comment">// If the user requested, print out the raw form data from </font>
00169     <font class="comment">// the vector of FormEntries.  This will contain every </font>
00170     <font class="comment">// element in the list.</font>
00171     <font class="comment">// This is one of two ways to get at form data, the other</font>
00172     <font class="comment">// being the use of Cgicc's getElement() methods.  </font>
00173     <font class="keywordflow">if</font>(cgi.queryCheckbox(<font class="stringliteral">"showFE"</font>))
00174       dumpList(cgi);
00175     
00176     <font class="comment">// If the user requested data via Cgicc's getElement() methods, do it.</font>
00177     <font class="comment">// This is different than the use of the list of FormEntries </font>
00178     <font class="comment">// because it requires prior knowledge of the name of form elements.</font>
00179     <font class="comment">// Usually they will be known, but you never know.</font>
00180     <font class="keywordflow">if</font>(cgi.queryCheckbox(<font class="stringliteral">"showForm"</font>))
00181       showForm(cgi);
00182 
00183     <font class="comment">// Now print out a footer with some fun info</font>
00184     cout &lt;&lt; p() &lt;&lt; CGICCNS div().set(<font class="stringliteral">"align"</font>,<font class="stringliteral">"center"</font>);
00185     cout &lt;&lt; a(<font class="stringliteral">"Back to form"</font>).set(<font class="stringliteral">"href"</font>, cgi.getEnvironment().getReferrer()) 
00186          &lt;&lt; endl;
00187     cout &lt;&lt; CGICCNS div() &lt;&lt; br() &lt;&lt; hr(set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"half"</font>)) &lt;&lt; endl;
00188     
00189     <font class="comment">// Information on cgicc</font>
00190     cout &lt;&lt; CGICCNS div().set(<font class="stringliteral">"align"</font>,<font class="stringliteral">"center"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"smaller"</font>) &lt;&lt; endl;
00191     cout &lt;&lt; <font class="stringliteral">"GNU cgi"</font> &lt;&lt; span(<font class="stringliteral">"cc"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"red"</font>) &lt;&lt; <font class="stringliteral">" v"</font>;
00192     cout &lt;&lt; cgi.getVersion() &lt;&lt; br() &lt;&lt; endl;
00193     cout &lt;&lt; <font class="stringliteral">"Compiled at "</font> &lt;&lt; cgi.getCompileTime();
00194     cout &lt;&lt; <font class="stringliteral">" on "</font> &lt;&lt; cgi.getCompileDate() &lt;&lt; br() &lt;&lt; endl;
00195 
00196     cout &lt;&lt; <font class="stringliteral">"Configured for "</font> &lt;&lt; cgi.getHost();  
00197 <font class="preprocessor">#if HAVE_UNAME</font>
00198 <font class="preprocessor"></font>    <font class="keyword">struct </font>utsname info;
00199     <font class="keywordflow">if</font>(uname(&amp;info) != -1) {
00200       cout &lt;&lt; <font class="stringliteral">". Running on "</font> &lt;&lt; info.sysname;
00201       cout &lt;&lt; <font class="charliteral">' '</font> &lt;&lt; info.release &lt;&lt; <font class="stringliteral">" ("</font>;
00202       cout &lt;&lt; info.nodename &lt;&lt; <font class="stringliteral">")."</font> &lt;&lt; endl;
00203     }
00204 <font class="preprocessor">#else</font>
00205 <font class="preprocessor"></font>    cout &lt;&lt; <font class="stringliteral">"."</font> &lt;&lt; endl;
00206 <font class="preprocessor">#endif</font>
00207 <font class="preprocessor"></font>
00208 <font class="preprocessor">#if HAVE_GETTIMEOFDAY</font>
00209 <font class="preprocessor"></font>    <font class="comment">// Information on this query</font>
00210     timeval end;
00211     gettimeofday(&amp;end, NULL);
00212     <font class="keywordtype">long</font> us = ((end.tv_sec - start.tv_sec) * 1000000)
00213       + (end.tv_usec - start.tv_usec);
00214 
00215     cout &lt;&lt; br() &lt;&lt; <font class="stringliteral">"Total time for request = "</font> &lt;&lt; us &lt;&lt; <font class="stringliteral">" us"</font>;
00216     cout &lt;&lt; <font class="stringliteral">" ("</font> &lt;&lt; (double) (us/1000000.0) &lt;&lt; <font class="stringliteral">" s)"</font>;
00217 <font class="preprocessor">#endif</font>
00218 <font class="preprocessor"></font>
00219     <font class="comment">// End of document</font>
00220     cout &lt;&lt; CGICCNS div() &lt;&lt; endl;
00221     cout &lt;&lt; body() &lt;&lt; html() &lt;&lt; endl;
00222 
00223     <font class="comment">// No chance for failure in this example</font>
00224     <font class="keywordflow">return</font> EXIT_SUCCESS;
00225   }
00226 
00227   <font class="comment">// Did any errors occur?</font>
00228   <font class="keywordflow">catch</font>(<font class="keyword">const</font> STDNS exception&amp; e) {
00229 
00230     <font class="comment">// This is a dummy exception handler, as it doesn't really do</font>
00231     <font class="comment">// anything except print out information.</font>
00232 
00233     <font class="comment">// Reset all the HTML elements that might have been used to </font>
00234     <font class="comment">// their initial state so we get valid output</font>
00235     html::reset();      head::reset();          body::reset();
00236     title::reset();     h1::reset();            h4::reset();
00237     comment::reset();   td::reset();            tr::reset(); 
00238     table::reset();     CGICCNS div::reset();   p::reset(); 
00239     a::reset();         h2::reset();            colgroup::reset();
00240 
00241     <font class="comment">// Output the HTTP headers for an HTML document, and the HTML 4.0 DTD info</font>
00242     cout &lt;&lt; HTTPHTMLHeader() &lt;&lt; HTMLDoctype(HTMLDoctype::eStrict) &lt;&lt; endl;
00243     cout &lt;&lt; html().set(<font class="stringliteral">"lang"</font>,<font class="stringliteral">"en"</font>).set(<font class="stringliteral">"dir"</font>,<font class="stringliteral">"ltr"</font>) &lt;&lt; endl;
00244 
00245     <font class="comment">// Set up the page's header and title.</font>
00246     <font class="comment">// I will put in lfs to ease reading of the produced HTML. </font>
00247     cout &lt;&lt; head() &lt;&lt; endl;
00248 
00249     <font class="comment">// Output the style sheet portion of the header</font>
00250     cout &lt;&lt; style() &lt;&lt; comment() &lt;&lt; endl;
00251     cout &lt;&lt; <font class="stringliteral">"body { color: black; background-color: white; }"</font> &lt;&lt; endl;
00252     cout &lt;&lt; <font class="stringliteral">"hr.half { width: 60%; align: center; }"</font> &lt;&lt; endl;
00253     cout &lt;&lt; <font class="stringliteral">"span.red, STRONG.red { color: red; }"</font> &lt;&lt; endl;
00254     cout &lt;&lt; <font class="stringliteral">"div.notice { border: solid thin; padding: 1em; margin: 1em 0; "</font>
00255          &lt;&lt; <font class="stringliteral">"background: #ddd; }"</font> &lt;&lt; endl;
00256 
00257     cout &lt;&lt; comment() &lt;&lt; style() &lt;&lt; endl;
00258 
00259     cout &lt;&lt; title(<font class="stringliteral">"GNU cgicc exception"</font>) &lt;&lt; endl;
00260     cout &lt;&lt; head() &lt;&lt; endl;
00261     
00262     cout &lt;&lt; body() &lt;&lt; endl;
00263     
00264     cout &lt;&lt; h1() &lt;&lt; <font class="stringliteral">"GNU cgi"</font> &lt;&lt; span(<font class="stringliteral">"cc"</font>, set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"red"</font>))
00265          &lt;&lt; <font class="stringliteral">" caught an exception"</font> &lt;&lt; h1() &lt;&lt; endl; 
00266   
00267     cout &lt;&lt; CGICCNS div().set(<font class="stringliteral">"align"</font>,<font class="stringliteral">"center"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"notice"</font>) &lt;&lt; endl;
00268 
00269     cout &lt;&lt; h2(e.what()) &lt;&lt; endl;
00270 
00271     <font class="comment">// End of document</font>
00272     cout &lt;&lt; CGICCNS div() &lt;&lt; endl;
00273     cout &lt;&lt; hr().set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"half"</font>) &lt;&lt; endl;
00274     cout &lt;&lt; body() &lt;&lt; html() &lt;&lt; endl;
00275     
00276     <font class="keywordflow">return</font> EXIT_SUCCESS;
00277   }
00278 }
00279 
00280 <font class="comment">// Print out a table of the CgiEnvironment</font>
00281 <font class="keywordtype">void</font>
00282 dumpEnvironment(<font class="keyword">const</font> CgiEnvironment&amp; env) 
00283 {
00284   <font class="comment">// This is just a brain-dead dump of information.</font>
00285   <font class="comment">// Almost all of this code is for HTML formatting</font>
00286   cout &lt;&lt; h2(<font class="stringliteral">"Environment information from CgiEnvironment"</font>) &lt;&lt; endl;
00287   
00288   cout &lt;&lt; CGICCNS div().set(<font class="stringliteral">"align"</font>,<font class="stringliteral">"center"</font>) &lt;&lt; endl;
00289   
00290   cout &lt;&lt; table().set(<font class="stringliteral">"border"</font>,<font class="stringliteral">"0"</font>).set(<font class="stringliteral">"rules"</font>,<font class="stringliteral">"none"</font>).set(<font class="stringliteral">"frame"</font>,<font class="stringliteral">"void"</font>)
00291                  .set(<font class="stringliteral">"cellspacing"</font>,<font class="stringliteral">"2"</font>).set(<font class="stringliteral">"cellpadding"</font>,<font class="stringliteral">"2"</font>)
00292                  .set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"cgi"</font>) &lt;&lt; endl;
00293   cout &lt;&lt; colgroup().set(<font class="stringliteral">"span"</font>,<font class="stringliteral">"2"</font>) &lt;&lt; endl;
00294   cout &lt;&lt; col().set(<font class="stringliteral">"align"</font>,<font class="stringliteral">"center"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>).set(<font class="stringliteral">"span"</font>,<font class="stringliteral">"1"</font>) 
00295        &lt;&lt; endl;
00296   cout &lt;&lt; col().set(<font class="stringliteral">"align"</font>,<font class="stringliteral">"left"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>).set(<font class="stringliteral">"span"</font>,<font class="stringliteral">"1"</font>) 
00297        &lt;&lt; endl;
00298   cout &lt;&lt; colgroup() &lt;&lt; endl;
00299   
00300   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Request Method"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00301        &lt;&lt; td(env.getRequestMethod()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00302   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Path Info"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00303        &lt;&lt; td(env.getPathInfo()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00304   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Path Translated"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00305        &lt;&lt; td(env.getPathTranslated()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00306   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Script Name"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00307        &lt;&lt; td(env.getScriptName()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00308   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"HTTP Referrer"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00309        &lt;&lt; td(env.getReferrer()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00310   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"HTTP Cookie"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00311        &lt;&lt; td(env.getCookies()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00312   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Query String"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00313        &lt;&lt; td(env.getQueryString()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00314   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Content Length"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00315        &lt;&lt; td().set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; env.getContentLength() 
00316        &lt;&lt; td() &lt;&lt; tr() &lt;&lt; endl;
00317   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Post Data"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>)
00318        &lt;&lt; td().set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>)
00319        &lt;&lt; pre(env.getPostData()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; td() 
00320        &lt;&lt; tr() &lt;&lt; endl;
00321   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Remote Host"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00322        &lt;&lt; td(env.getRemoteHost()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00323   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Remote Address"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00324        &lt;&lt; td(env.getRemoteAddr()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00325   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Authorization Type"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00326        &lt;&lt; td(env.getAuthType()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00327   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Remote User"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00328        &lt;&lt; td(env.getRemoteUser()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00329   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Remote Identification"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00330        &lt;&lt; td(env.getRemoteIdent()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00331   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Content Type"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00332        &lt;&lt; td(env.getContentType()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00333   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"HTTP Accept"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00334        &lt;&lt; td(env.getAccept()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00335   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"User Agent"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00336        &lt;&lt; td(env.getUserAgent()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00337   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Server Software"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00338        &lt;&lt; td(env.getServerSoftware()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00339   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Server Name"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00340        &lt;&lt; td(env.getServerName()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00341   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Gateway Interface"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00342        &lt;&lt; td(env.getGatewayInterface()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00343   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Server Protocol"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00344        &lt;&lt; td(env.getServerProtocol()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00345   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Server Port"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00346        &lt;&lt; td().set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; env.getServerPort() 
00347        &lt;&lt; td() &lt;&lt; tr() &lt;&lt; endl;
00348   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"HTTPS"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>)
00349        &lt;&lt; td().set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; (env.usingHTTPS() ? <font class="stringliteral">"true"</font> : <font class="stringliteral">"false"</font>)
00350        &lt;&lt; td() &lt;&lt; tr() &lt;&lt; endl;
00351   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Redirect Request"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00352        &lt;&lt; td(env.getRedirectRequest()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00353   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Redirect URL"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00354        &lt;&lt; td(env.getRedirectURL()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00355   cout &lt;&lt; tr() &lt;&lt; td(<font class="stringliteral">"Redirect Status"</font>).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) 
00356        &lt;&lt; td(env.getRedirectStatus()).set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; tr() &lt;&lt; endl;
00357   
00358   cout &lt;&lt; table() &lt;&lt; CGICCNS div() &lt;&lt; endl;
00359 }
00360 
00361 <font class="comment">// Print out the value of every form element</font>
00362 <font class="keywordtype">void</font>
00363 dumpList(<font class="keyword">const</font> Cgicc&amp; formData) 
00364 {
00365   cout &lt;&lt; h2(<font class="stringliteral">"Form Data via vector"</font>) &lt;&lt; endl;
00366   
00367   cout &lt;&lt; CGICCNS div().set(<font class="stringliteral">"align"</font>,<font class="stringliteral">"center"</font>) &lt;&lt; endl;
00368   
00369   cout &lt;&lt; table().set(<font class="stringliteral">"border"</font>,<font class="stringliteral">"0"</font>).set(<font class="stringliteral">"rules"</font>,<font class="stringliteral">"none"</font>).set(<font class="stringliteral">"frame"</font>,<font class="stringliteral">"void"</font>)
00370                  .set(<font class="stringliteral">"cellspacing"</font>,<font class="stringliteral">"2"</font>).set(<font class="stringliteral">"cellpadding"</font>,<font class="stringliteral">"2"</font>)
00371                  .set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"cgi"</font>) &lt;&lt; endl;
00372   cout &lt;&lt; colgroup().set(<font class="stringliteral">"span"</font>,<font class="stringliteral">"2"</font>) &lt;&lt; endl;
00373   cout &lt;&lt; col().set(<font class="stringliteral">"align"</font>,<font class="stringliteral">"center"</font>).set(<font class="stringliteral">"span"</font>,<font class="stringliteral">"2"</font>) &lt;&lt; endl;
00374   cout &lt;&lt; colgroup() &lt;&lt; endl;
00375   
00376   cout &lt;&lt; tr().set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"title"</font>) &lt;&lt; td(<font class="stringliteral">"Element Name"</font>) 
00377        &lt;&lt; td(<font class="stringliteral">"Element Value"</font>) &lt;&lt; tr() &lt;&lt; endl;
00378   
00379   <font class="comment">// Iterate through the vector, and print out each value</font>
00380   <a class="code" href="namespacecgicc.html#a1">const_form_iterator</a> iter;
00381   <font class="keywordflow">for</font>(iter = formData.getElements().begin(); 
00382       iter != formData.getElements().end(); 
00383       ++iter) {
00384     cout &lt;&lt; tr().set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"data"</font>) &lt;&lt; td(iter-&gt;getName()) 
00385          &lt;&lt; td(iter-&gt;getValue()) &lt;&lt; tr() &lt;&lt; endl;
00386   }
00387   cout &lt;&lt; table() &lt;&lt; CGICCNS div() &lt;&lt; endl;
00388 }
00389 
00390 <font class="comment">// Print out information customized for each element</font>
00391 <font class="keywordtype">void</font>
00392 showForm(<font class="keyword">const</font> Cgicc&amp; formData) 
00393 {
00394 
00395   <font class="comment">// I am using an if statement to check if each element is found</font>
00396   cout &lt;&lt; h2(<font class="stringliteral">"Form Data via Cgicc"</font>) &lt;&lt; endl;
00397   
00398   cout &lt;&lt; CGICCNS div().set(<font class="stringliteral">"class"</font>,<font class="stringliteral">"notice"</font>) &lt;&lt; endl;
00399 
00400   <font class="comment">//getElement</font>
00401   <a class="code" href="namespacecgicc.html#a1">const_form_iterator</a> name = formData.getElement(<font class="stringliteral">"name"</font>);
00402   <font class="keywordflow">if</font>(name != (*formData).end() &amp;&amp; ! name-&gt;isEmpty())
00403     cout &lt;&lt; <font class="stringliteral">"Your name is "</font> &lt;&lt; **name &lt;&lt; <font class="charliteral">'.'</font> &lt;&lt; br() &lt;&lt; endl;
00404   <font class="keywordflow">else</font>
00405     cout &lt;&lt; <font class="stringliteral">"You don't have a name."</font> &lt;&lt; br() &lt;&lt; endl;
00406 
00407   <font class="comment">// getElement and getDoubleValue</font>
00408   <a class="code" href="namespacecgicc.html#a1">const_form_iterator</a> salary = formData.getElement(<font class="stringliteral">"bucks"</font>);
00409   <font class="keywordflow">if</font>(salary != (*formData).end() &amp;&amp; ! salary-&gt;isEmpty())
00410     cout &lt;&lt; <font class="stringliteral">"You make "</font> &lt;&lt; (*salary).getDoubleValue(80, 120) 
00411          &lt;&lt; <font class="stringliteral">" million dollars."</font> &lt;&lt; br() &lt;&lt; endl;
00412   <font class="keywordflow">else</font>
00413     cout &lt;&lt; <font class="stringliteral">"You don't have a salary."</font> &lt;&lt; br() &lt;&lt; endl;
00414 
00415   <font class="comment">// getElement and getIntegerValue</font>
00416   <a class="code" href="namespacecgicc.html#a1">const_form_iterator</a> hours = formData.getElement(<font class="stringliteral">"time"</font>);
00417   <font class="keywordflow">if</font>(hours != (*formData).end() &amp;&amp; ! (*hours).isEmpty())
00418     cout &lt;&lt; <font class="stringliteral">"You've wasted "</font> &lt;&lt; (*hours).getIntegerValue() 
00419          &lt;&lt; <font class="stringliteral">" hours on the web."</font> &lt;&lt; br() &lt;&lt; endl;
00420   <font class="keywordflow">else</font>
00421     cout &lt;&lt; <font class="stringliteral">"You haven't wasted any time on the web."</font> &lt;&lt; br() &lt;&lt; endl;
00422 
00423   <font class="comment">// getElement and getStrippedValue</font>
00424   <a class="code" href="namespacecgicc.html#a1">const_form_iterator</a> thoughts = formData.getElement(<font class="stringliteral">"thoughts"</font>);
00425   <font class="keywordflow">if</font>(thoughts != (*formData).end() &amp;&amp; ! (*thoughts).isEmpty()) {
00426     STDNS string temp = (*thoughts).getStrippedValue();
00427     cout &lt;&lt; <font class="stringliteral">"Your thoughts : "</font> &lt;&lt; temp &lt;&lt; br() &lt;&lt; endl;
00428   }
00429   <font class="keywordflow">else</font>
00430     cout &lt;&lt; <font class="stringliteral">"You don't have any thoughts!?"</font> &lt;&lt; br() &lt;&lt; endl;
00431   
00432   <font class="comment">// queryCheckbox</font>
00433   <font class="keywordflow">if</font>(formData.queryCheckbox(<font class="stringliteral">"hungry"</font>))
00434     cout &lt;&lt; <font class="stringliteral">"You are hungry."</font> &lt;&lt; br() &lt;&lt; endl;
00435   <font class="keywordflow">else</font>
00436     cout &lt;&lt; <font class="stringliteral">"You are not hungry."</font> &lt;&lt; br() &lt;&lt; endl;
00437 
00438   <font class="comment">// getElement</font>
00439   STDNS vector&lt;FormEntry&gt; flavors;
00440   formData.getElement(<font class="stringliteral">"flavors"</font>, flavors);
00441   <font class="keywordflow">if</font>(! flavors.empty()) {
00442     cout &lt;&lt; <font class="stringliteral">"You like "</font>;
00443     <font class="keywordflow">for</font>(STDNS string::size_type i = 0; i &lt; flavors.size(); i++) {
00444       cout &lt;&lt; flavors[i].getValue();
00445       <font class="keywordflow">if</font>(i &lt; flavors.size() - 2)
00446         cout &lt;&lt; <font class="stringliteral">", "</font>;
00447       <font class="keywordflow">else</font> <font class="keywordflow">if</font>(i == flavors.size() - 2)
00448         cout &lt;&lt; <font class="stringliteral">" and "</font>;
00449     }
00450     cout &lt;&lt; <font class="stringliteral">" ice cream."</font> &lt;&lt; br() &lt;&lt; endl;
00451   }
00452   <font class="keywordflow">else</font>
00453     cout &lt;&lt; <font class="stringliteral">"You don't like ice cream!?"</font> &lt;&lt; br() &lt;&lt; endl;
00454   
00455   <font class="comment">// getElement</font>
00456   <a class="code" href="namespacecgicc.html#a1">const_form_iterator</a> hair = formData.getElement(<font class="stringliteral">"hair"</font>);
00457   <font class="keywordflow">if</font>(hair != (*formData).end())
00458     cout &lt;&lt; <font class="stringliteral">"Your hair is "</font> &lt;&lt; **hair &lt;&lt; <font class="charliteral">'.'</font> &lt;&lt; br() &lt;&lt; endl;
00459   <font class="keywordflow">else</font>
00460     cout &lt;&lt; <font class="stringliteral">"You don't have any hair."</font> &lt;&lt; br() &lt;&lt; endl;
00461   
00462   <a class="code" href="namespacecgicc.html#a1">const_form_iterator</a> vote = formData.getElement(<font class="stringliteral">"vote"</font>);
00463   <font class="keywordflow">if</font>(vote != (*formData).end())
00464     cout &lt;&lt; <font class="stringliteral">"You voted for "</font> &lt;&lt; **vote &lt;&lt; <font class="charliteral">'.'</font> &lt;&lt; br() &lt;&lt; endl;
00465   <font class="keywordflow">else</font>
00466     cout &lt;&lt; <font class="stringliteral">"This should never happen. ERROR!"</font> &lt;&lt; br() &lt;&lt; endl;
00467   
00468   <font class="comment">// getElement</font>
00469   STDNS vector&lt;FormEntry&gt; friends;
00470   formData.getElement(<font class="stringliteral">"friends"</font>, friends);
00471   <font class="keywordflow">if</font>(! friends.empty()) {
00472     cout &lt;&lt; <font class="stringliteral">"You like "</font>;
00473     <font class="keywordflow">for</font>(STDNS string::size_type i = 0; i &lt; friends.size(); i++) {
00474       cout &lt;&lt; friends[i].getValue();
00475       <font class="keywordflow">if</font>(i &lt; friends.size() - 2)
00476         cout &lt;&lt; <font class="stringliteral">", "</font>;
00477       <font class="keywordflow">else</font> <font class="keywordflow">if</font>(i == friends.size() - 2)
00478         cout &lt;&lt; <font class="stringliteral">" and "</font>;
00479     }
00480     cout &lt;&lt; <font class="stringliteral">" on Friends."</font> &lt;&lt; br() &lt;&lt; endl;
00481   }
00482   <font class="keywordflow">else</font>
00483     cout &lt;&lt; <font class="stringliteral">"You don't watch Friends!?"</font> &lt;&lt; br() &lt;&lt; endl;
00484   
00485   cout &lt;&lt; CGICCNS div() &lt;&lt; endl;
00486 }
</pre></div><!-- $Id: footer.html,v 1.3 2002/03/09 18:30:37 sbooth Exp $ -->

<hr>

<address><small>
GNU cgicc - A C++ class library for writing CGI applications<br />
Copyright &copy; 1996 - 2002 
<a href="mailto:sbooth@gnu.org">Stephen F. Booth</a><br />
Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.1 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with no Front Cover Texts, and with no Back-Cover
Texts.<br />
Documentation generated Sun Mar 17 16:40:57 2002 for cgicc by
<a HREF="http://www.doxygen.org/index.html">doxygen</a> 1.2.13.1
</small></address>

</body>

</html>

